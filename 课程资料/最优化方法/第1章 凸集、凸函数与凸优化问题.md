# 第1章 凸集、凸函数与凸优化问题


## 基础知识

### 向量和矩阵

**定义1 (范数)**
一个从向量空间 $\mathbb{R}^n$ 到实数域 $\mathbb{R}$ 的函数 $\|\cdot\|$ 被称为范数，如果它满足以下条件：
1.  **正定性 (Positive definiteness)**: $\|v\| \ge 0$ 对所有 $v \in \mathbb{R}^n$ 成立，且 $\|v\| = 0$ 当且仅当 $v=0$。
2.  **齐次性 (Homogeneity)**: $\|\alpha v\| = |\alpha| \|v\|$ 对所有 $v \in \mathbb{R}^n, \alpha \in \mathbb{R}$ 成立。
3.  **三角不等式 (Triangle inequality)**: $\|v+w\| \le \|v\| + \|w\|$ 对所有 $v, w \in \mathbb{R}^n$ 成立。

> 直观理解：范数是衡量向量“长度”或“大小”的一种方式。

对于给定向量 $x, y \in \mathbb{R}^n$：
-   **内积**: $\langle x, y \rangle = x^T y = \sum_{i=1}^n x_i y_i$
-   **$l_2$ 范数 (欧几里得范数)**: $\|x\|_2 = \left( \sum_{i=1}^n |x_i|^2 \right)^{1/2}$ (通常简写为 $\|x\|$)
-   **$l_1$ 范数 (曼哈顿范数)**: $\|x\|_1 = \sum_{i=1}^n |x_i|$
-   **$l_\infty$ 范数 (最大范数)**: $\|x\|_\infty = \max_{1 \le i \le n} |x_i|$
-   **$l_p$ 范数** ($p \ge 1$): $\|x\|_p = \left( \sum_{i=1}^n |x_i|^p \right)^{1/p}$
-   **$l_0$ "范数"**: $\|x\|_0$ 是 $x$ 中非零元素的个数 (注意：它不是一个真正的范数，因为它不满足齐次性)。

**命题1 (范数不等式)**
对任意 $x \in \mathbb{R}^n$，有：
$$
\|x\|_\infty \le \|x\|_2 \le \|x\|_1 \le n\|x\|_\infty
$$
-   **Cauchy-Schwarz 不等式**: $|\langle x, y \rangle| \le \|x\|_2 \|y\|_2$
-   **Hölder 不等式**: $|\langle x, y \rangle| \le \|x\|_p \|y\|_q$，其中 $\frac{1}{p} + \frac{1}{q} = 1$
-   **Minkowski 不等式 (三角不等式的推广)**: $\|x+y\|_p \le \|x\|_p + \|y\|_p$

对于矩阵 $A, B \in \mathbb{R}^{m \times n}$:
-   **内积**: $\langle A, B \rangle = \text{tr}(A^T B) = \sum_{i,j} A_{ij} B_{ij}$ （注意是所有元素相乘求和）
-   **Frobenius 范数**: $\|A\|_F = \left( \sum_{i,j} |A_{ij}|^2 \right)^{1/2} = \sqrt{\text{tr}(A^T A)}$
-   **诱导范数 (算子范数)**:
    $$
    \|A\| = \sup_{\|x\|=1} \|Ax\| = \sup_{x \neq 0} \frac{\|Ax\|}{\|x\|}
    $$
-   **核范数**: $\|A\|_* = \sum_{i=1}^{\text{rank}(A)} \sigma_i(A)$，其中 $\sigma_i(A)$ 是 $A$ 的奇异值。

**命题2 (矩阵范数性质)**
对任意相容的矩阵 $A, B$ 和向量 $x$，有：
$$
\|AB\| \le \|A\|\|B\|, \quad \|Ax\| \le \|A\|\|x\|
$$

-   **对称矩阵**: $A^T = A$
-   **对称半正定矩阵 (PSD)**: $A^T = A$ 且对所有 $x \in \mathbb{R}^n$，有 $x^T A x \ge 0$。记为 $A \succeq 0$。
-   **对称正定矩阵 (PD)**: $A^T = A$ 且对所有 $x \neq 0$，有 $x^T A x > 0$。记为 $A \succ 0$。

### 梯度和海瑟矩阵

**定义2 (梯度 Gradient)**
给定函数 $f: \mathbb{R}^n \to \mathbb{R}$，若存在向量 $g \in \mathbb{R}^n$ 使得对任意 $d \to 0$ 满足：
$$
\lim_{d \to 0} \frac{f(x+d) - f(x) - g^T d}{\|d\|} = 0
$$
则称 $f$ 在点 $x$ 处可微，向量 $g$ 称为 $f$ 在点 $x$ 处的**梯度**，记作 $\nabla f(x)$。
如果 $f$ 的所有偏导数都存在且连续，则梯度为：
$$
\nabla f(x) = \begin{pmatrix} \frac{\partial f(x)}{\partial x_1} \\ \frac{\partial f(x)}{\partial x_2} \\ \vdots \\ \frac{\partial f(x)}{\partial x_n} \end{pmatrix}
$$
> 直观理解：梯度向量指向函数值增长最快的方向，其大小表示增长的速率。

**定义3 (海瑟矩阵 Hessian)**
如果函数 $f: \mathbb{R}^n \to \mathbb{R}$ 在点 $x$ 处的所有二阶偏导数都存在，则其**海瑟矩阵** $\nabla^2 f(x)$ 定义为：
$$
\nabla^2 f(x) = \begin{pmatrix}
\frac{\partial^2 f}{\partial x_1^2} & \frac{\partial^2 f}{\partial x_1 \partial x_2} & \cdots & \frac{\partial^2 f}{\partial x_1 \partial x_n} \\
\frac{\partial^2 f}{\partial x_2 \partial x_1} & \frac{\partial^2 f}{\partial x_2^2} & \cdots & \frac{\partial^2 f}{\partial x_2 \partial x_n} \\
\vdots & \vdots & \ddots & \vdots \\
\frac{\partial^2 f}{\partial x_n \partial x_1} & \frac{\partial^2 f}{\partial x_n \partial x_2} & \cdots & \frac{\partial^2 f}{\partial x_n^2}
\end{pmatrix}
$$
> 直观理解：海瑟矩阵描述了函数的局部曲率。如果函数二阶连续可微，则海瑟矩阵是对称的。

**例题1**：计算二次函数 $f(x) = \frac{1}{2}x^T Q x + q^T x + r$ 的梯度和海瑟矩阵（$Q$为对称矩阵）。
**解**：
-   梯度：$\nabla f(x) = Qx + q$
-   海瑟矩阵：$\nabla^2 f(x) = Q$

**例题2**：计算最小二乘函数 $f(x) = \frac{1}{2}\|Ax-b\|_2^2$ 的梯度和海瑟矩阵。
**解**：
-   $f(x) = \frac{1}{2}(Ax-b)^T(Ax-b) = \frac{1}{2}(x^T A^T A x - 2b^T A x + b^T b)$
-   梯度：$\nabla f(x) = A^T(Ax-b)$
-   海瑟矩阵：$\nabla^2 f(x) = A^T A$

**定理1 (泰勒展开定理)**
1.  **一阶展开**: 若 $f$ 连续可微，则
    $$
    f(x+d) = f(x) + \nabla f(x)^T d + o(\|d\|)
    $$
    且存在 $t \in (0,1)$ 使得 $f(x+d) = f(x) + \nabla f(x+td)^T d$。
2.  **二阶展开**: 若 $f$ 二阶连续可微，则
    $$
    f(x+d) = f(x) + \nabla f(x)^T d + \frac{1}{2}d^T \nabla^2 f(x) d + o(\|d\|^2)
    $$
    且存在 $\gamma \in (0,1)$ 使得 $f(x+d) = f(x) + \nabla f(x)^T d + \frac{1}{2}d^T \nabla^2 f(x+\gamma d) d$。


总结速查表

**符号约定**:
-   $y$: 标量
-   $x, a, b$: 列向量, $x \in \mathbb{R}^n$
-   $A, Q$: 矩阵
-   $\frac{\partial y}{\partial x}$: 结果是一个与 $x$ 形状相同的**列向量**。
-   $\frac{\partial y}{\partial A}$: 结果是一个与 $A$ 形状相同的**矩阵**。


| 函数 (Function) $y$ | 对 $x$ 的导数 $\frac{\partial y}{\partial x}$ | 备注              |
| :------------------ | :-------------------------------------------- | :---------------- |
| $a^T x$             | $a$                                           |                   |
| $x^T A x$           | $(A + A^T)x$                                  |                   |
| $x^T A x$           | $2Ax$                                         | $A$ 是对称矩阵    |
| $\|x\|_2^2 = x^T x$ | $2x$                                          | $A=I$ 的特殊情况  |
| $\|Ax - b\|_2^2$    | $2A^T(Ax - b)$                                | 最小二乘          |
| $\|x\|_2$           | $\frac{x}{\|x\|_2}$                           | 在 $x=0$ 处不可导 |


### 优化中的一些基本概念

#### 基本数学模型
$$
\begin{aligned}
\text{minimize} \quad & f(x) \\
\text{subject to} \quad & x \in \Omega
\end{aligned}
$$
-   **决策变量**: $x = (x_1, \dots, x_n)^T$
-   **目标函数**: $f: \Omega \to \mathbb{R}$
-   **可行域 (决策集)**: $\Omega \subseteq \mathbb{R}^n$，$\Omega$ 中的点称为**可行点**。
-   若 $\Omega = \mathbb{R}^n$，称为**无约束优化**；否则称为**约束优化**。

#### 基本定义
-   **全局最优解**: $x^* \in \Omega$ 是全局最优解，如果对所有 $x \in \Omega$，都有 $f(x^*) \le f(x)$。
-   **局部最优解**: $x^* \in \Omega$ 是局部最优解，如果存在一个邻域 $\mathcal{B}(x^*, \delta)$，使得对所有 $x \in \Omega \cap \mathcal{B}(x^*, \delta)$，都有 $f(x^*) \le f(x)$。

#### 迭代算法基本框架
1.  **步1 (初始化)**: 选取初始点 $x^0$，设置参数，令 $k=0$。
2.  **步2 (终止检验)**: 检查是否满足停机准则。
3.  **步3 (搜索方向)**: 寻找一个下降方向 $d^k$，使得 $\nabla f(x^k)^T d^k < 0$。
4.  **步4 (步长)**: 计算步长 $\alpha_k > 0$，使得 $f(x^k + \alpha_k d^k) < f(x^k)$。
5.  **步5 (更新)**: 更新迭代点 $x^{k+1} := x^k + \alpha_k d^k$，令 $k := k+1$，返回步2。

#### 优化问题分类
-   **约束**：约束优化 vs. 无约束优化
-   **函数性质**：线性规划(LP)、二次规划(QP)、非线性规划(NLP)
-   **凸性**：凸优化 vs. 非凸优化
-   **光滑性**：光滑优化 vs. 非光滑优化
-   **确定性**：确定性优化 vs. 不确定性优化 (随机优化、鲁棒优化)

#### 算法评价标准
-   **收敛性**
    -   **全局收敛**: 从**任意**初始点出发，算法都能收敛到最优点。
    -   **局部收敛**: 只有当初始点**足够靠近**最优点时，算法才能保证收敛。
-   **收敛速度**
    -   **Q-线性收敛**: $\frac{\|x^{k+1}-x^*\|}{\|x^k-x^*\|} \le r$ for $r \in (0,1)$。
    -   **Q-超线性收敛**: $\frac{\|x^{k+1}-x^*\|}{\|x^k-x^*\|} \to 0$。
    -   **Q-p阶收敛**: $\frac{\|x^{k+1}-x^*\|}{\|x^k-x^*\|^p} \le \gamma$ for $p>1$。
    -   **R-收敛**: 比Q-收敛更弱的收敛性度量， $\|x^k - x^*\| \le \nu_k$，其中 $\{\nu_k\}$ 是一个Q-收敛于0的序列。
-   **其它标准**: 计算复杂度、存储消耗、数值稳定性等。

## 凸集

### 凸, 仿射, 锥

#### 集合 (Sets)

| 概念      | 定义                                                   | 数学表达式                                                                                                                        | 备注                    |
| :------ | :--------------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------- | :-------------------- |
| **凸集**  | 集合中任意两点之间的**线段**都在集合内。                               | $x_1, x_2 \in C \implies \theta_1 x_1 + \theta_2 x_2 \in C, \quad \forall \theta_1 + \theta_2 = 1, \theta_1, \theta_2 \ge 0$ | 线段上的点必须在集合内。          |
| **仿射集** | 集合中任意两点之间的**直线**都在集合内。                               | $x_1, x_2 \in C \implies \theta_1 x_1 + \theta_2 x_2 \in C, \quad \forall \theta_1 + \theta_2 = 1$                           | 直线上的点必须在集合内。仿射集一定是凸集。 |
| **凸锥**  | 集合是锥（对任意点$x$，所有$\theta x$($\theta \ge 0$)都在集合内）且是凸集。 | $x_1, x_2 \in C \implies \theta_1 x_1 + \theta_2 x_2 \in C, \quad \forall \theta_1, \theta_2 \ge 0$                          | 必须包含原点。**凸锥一定是凸集**。   |

#### 组合 (Combinations)

给定点 $x_1, \dots, x_m \in \mathbb{R}^n$:

| 概念         | 定义                            | 数学表达式                                                                           | 备注                     |
| :----------- | :------------------------------ | :----------------------------------------------------------------------------------- | :----------------------- |
| **凸组合**   | 点的线性组合，系数非负且和为1。 | $\sum_{i=1}^m \theta_i x_i, \quad \forall \theta_i \ge 0, \sum_{i=1}^m \theta_i = 1$ | 可以理解为点的加权平均。 |
| **仿射组合** | 点的线性组合，系数和为1。       | $\sum_{i=1}^m \theta_i x_i, \quad \forall \sum_{i=1}^m \theta_i = 1$                 | 系数可以为负。           |
| **凸锥组合** | 点的线性组合，系数非负。        | $\sum_{i=1}^m \theta_i x_i, \quad \forall \theta_i \ge 0$                            | 系数和没有限制。         |

#### 包 (Hulls)

| 概念                | 定义                              | 数学表达式                                                                                                 | 备注                          |
| :------------------ | :-------------------------------- | :--------------------------------------------------------------------------------------------------------- | :---------------------------- |
| **凸包** `conv C`   | 包含集合$C$中所有点的最小凸集。   | $\text{conv}(C) = \{ \sum_{i=1}^k \theta_i x_i \| x_i \in C, \theta_i \ge 0, \sum_{i=1}^k \theta_i = 1 \}$ | 由$C$中点的所有凸组合构成。   |
| **仿射包** `aff C`  | 包含集合$C$中所有点的最小仿射集。 | $\text{aff}(C) = \{ \sum_{i=1}^k \theta_i x_i \| x_i \in C, \sum_{i=1}^k \theta_i = 1 \}$                  | 由$C$中点的所有仿射组合构成。 |
| **凸锥包** `cone C` | 包含集合$C$中所有点的最小凸锥。   | $\text{cone}(C) = \{ \sum_{i=1}^k \theta_i x_i \| x_i \in C, \theta_i \ge 0 \}$                            | 由$C$中点的所有凸锥组合构成。 |

### 凸集例子

#### 超平面和半空间

**定理1 (超平面)**
一个超平面是具有以下形式的集合：
$$
\{ x \in \mathbb{R}^n \mid a^T x = b \}
$$
其中 $a \in \mathbb{R}^n, a \neq 0, b \in \mathbb{R}$。
> 直观理解：在三维空间中，超平面就是一个平面；在二维空间中，超平面就是一条直线。它由法向量$a$和偏移量$b$唯一确定。超平面是仿射集，也是凸集。

**定理2 (半空间)**
一个（闭的）半空间是具有以下形式的集合：
$$
\{ x \in \mathbb{R}^n \mid a^T x \le b \}
$$
其中 $a \in \mathbb{R}^n, a \neq 0, b \in \mathbb{R}$。
> 直观理解：一个超平面将整个空间分成两部分，每一部分就是一个半空间。半空间是凸集，但不是仿射集（除非它本身就是一个超平面）。

#### 范数球和椭球

**定理3 (范数球)**
一个范数球 $B(x_c, r)$ 定义为：
$$
B(x_c, r) = \{ x \in \mathbb{R}^n \mid \|x - x_c\|_p \le r \}
$$
其中 $x_c$ 是球心，$r > 0$ 是半径，$\|\cdot\|_p$ 是任意 $l_p$-范数 ($p \ge 1$)。
> 直观理解：这是我们熟悉的空间中的球体概念的推广。当$p=2$时是欧几里得球；当$p=1$时是菱形（二维）或钻石体（三维）；当$p=\infty$时是正方形（二维）或立方体（三维）。所有范数球都是凸集。

**例题1**：证明 $l_2$-范数球 $B(x_c, r) = \{ x \mid \|x - x_c\|_2 \le r \}$ 是凸集。
**证明**：
1.  取任意两点 $x_1, x_2 \in B(x_c, r)$，这意味着 $\|x_1 - x_c\|_2 \le r$ 且 $\|x_2 - x_c\|_2 \le r$。
2.  取任意 $\theta \in [0, 1]$，我们需要证明它们的凸组合 $\theta x_1 + (1-\theta)x_2$ 也在球内。
3.  考察点到球心的距离：
    $$
    \begin{aligned}
    \|\theta x_1 + (1-\theta)x_2 - x_c\|_2 &= \|\theta(x_1 - x_c) + (1-\theta)(x_2 - x_c)\|_2 \\
    &\le \|\theta(x_1 - x_c)\|_2 + \|(1-\theta)(x_2 - x_c)\|_2 \quad (\text{三角不等式}) \\
    &= \theta\|x_1 - x_c\|_2 + (1-\theta)\|x_2 - x_c\|_2 \quad (\text{范数齐次性}) \\
    &\le \theta r + (1-\theta)r = r
    \end{aligned}
    $$
4.  因此，$\theta x_1 + (1-\theta)x_2 \in B(x_c, r)$，范数球是凸集。

**定理4 (椭球)**
一个椭球 $\mathcal{E}$ 定义为：
$$
\mathcal{E} = \{ x \in \mathbb{R}^n \mid (x - x_c)^T P (x - x_c) \le 1 \}
$$
其中 $P$ 是一个对称正定矩阵 ($P \succ 0$)，$x_c$ 是中心。
> 直观理解：椭球是范数球的仿射变换，因此也是凸集。矩阵$P$的特征值决定了椭球在各个主轴方向上的伸缩程度。

#### 多面体和单纯形

**定理5 (多面体)**
多面体被定义为有限个线性等式和不等式约束的解集：
$$
\mathcal{P} = \{ x \in \mathbb{R}^n \mid Ax \le b, Cx = d \}
$$
> 直观理解：多面体是有限个半空间和超平面的交集。由于半空间和超平面都是凸集，且交集运算保持凸性，所以多面体是凸集。

**定理6 (单纯形)**
由 $k+1$ 个仿射独立的点 $v_0, \dots, v_k \in \mathbb{R}^n$ 定义的单纯形是这些点的凸包：
$$
C = \text{conv}\{v_0, \dots, v_k\} = \left\{ \theta_0 v_0 + \dots + \theta_k v_k \mid \sum_{i=0}^k \theta_i = 1, \theta_i \ge 0 \right\}
$$
> 直观理解：0-单纯形是点，1-单纯形是线段，2-单纯形是三角形，3-单纯形是四面体。

#### 对称矩阵和正定矩阵

**定理7 (对称半正定矩阵集合)**
所有 $n \times n$ 对称半正定矩阵的集合 $S_+^n$ 是一个凸锥。
$$
S_+^n = \{ A \in S^n \mid A \succeq 0 \}
$$
其中 $S^n$ 是所有 $n \times n$ 对称矩阵的集合。
> 直观理解：两个半正定矩阵的非负线性组合仍然是半正定矩阵，这符合凸锥的定义。

**例题2**：证明 $S_+^n$ 是凸锥。
**证明**：
1.  取任意两个矩阵 $A_1, A_2 \in S_+^n$，这意味着 $A_1, A_2$ 都是对称半正定矩阵。
2.  取任意非负标量 $\theta_1, \theta_2 \ge 0$。
3.  我们需要证明 $\theta_1 A_1 + \theta_2 A_2$ 也是对称半正定的。
4.  对于任意向量 $x \in \mathbb{R}^n$：
    $$
    x^T (\theta_1 A_1 + \theta_2 A_2) x = \theta_1 (x^T A_1 x) + \theta_2 (x^T A_2 x)
    $$
5.  因为 $A_1, A_2 \succeq 0$，所以 $x^T A_1 x \ge 0$ 和 $x^T A_2 x \ge 0$。
6.  因为 $\theta_1, \theta_2 \ge 0$，所以上式结果 $\ge 0$。
7.  因此，$\theta_1 A_1 + \theta_2 A_2 \succeq 0$，集合 $S_+^n$ 是一个凸锥。

### 保凸运算

**定理8 (交集)**
任意多个凸集的交集是凸集。
> 直观理解：如果一个点同时在所有集合中，那么连接它的线段上的点也必须同时在所有集合中。多面体就是这个性质的一个重要应用。

**定理9 (仿射变换)**
若 $S \subseteq \mathbb{R}^n$ 是凸集，函数 $f(x) = Ax+b$ 是一个仿射变换，则：
1.  $S$ 的像 $f(S) = \{ f(x) \mid x \in S \}$ 是凸集。
2.  $S$ 的原像 $f^{-1}(S) = \{ x \mid f(x) \in S \}$ 是凸集。
> 直观理解：仿射变换（线性变换加平移）可以看作是对空间的旋转、缩放、平移，这些操作不会破坏集合的凸性。

**定理10 (缩放、位移、和、直积)**
若 $S, S_1, S_2$ 是凸集，$\alpha \in \mathbb{R}, a \in \mathbb{R}^n$：
1.  **缩放**：$\alpha S = \{ \alpha x \mid x \in S \}$ 是凸集。
2.  **位移**：$a+S = \{ a+x \mid x \in S \}$ 是凸集。
3.  **和**：$S_1+S_2 = \{ x_1+x_2 \mid x_1 \in S_1, x_2 \in S_2 \}$ 是凸集。
4.  **直积**：$S_1 \times S_2 = \{ (x_1, x_2) \mid x_1 \in S_1, x_2 \in S_2 \}$ 是凸集。

**定理11 (透视函数)**
透视函数 $P: \mathbb{R}^{n+1} \to \mathbb{R}^n$ 定义为 $P(z, t) = z/t$，其定义域为 $\text{dom} P = \mathbb{R}^n \times \mathbb{R}_{++}$。
1.  若 $C \subseteq \text{dom} P$ 是凸集，则其像 $P(C)$ 是凸集。
2.  若 $C \subseteq \mathbb{R}^n$ 是凸集，则其原像 $P^{-1}(C)$ 是凸集。
> 直观理解：透视函数模拟了小孔成像，将三维物体投影到二维平面上。这个过程保持了物体的凸性。

## 凸函数

### 凸函数定义

#### 基本定义

**定义10 (凸函数)**
一个函数 $f: \mathbb{R}^n \to \mathbb{R}$ 是凸函数，如果它的定义域 $\text{dom} f$ 是一个凸集，并且对于所有 $x, y \in \text{dom} f$ 和 $\theta \in [0, 1]$，满足：
$$
f(\theta x + (1-\theta)y) \le \theta f(x) + (1-\theta)f(y)
$$
> 直观理解：函数图像上任意两点之间的弦都在这两点之间函数图像的上方。

-   **严格凸函数**：当 $x \neq y$ 且 $\theta \in (0, 1)$ 时，上述不等式严格成立 ($<$)。
-   **凹函数**：如果 $-f$ 是凸函数。
-   **严格凹函数**：如果 $-f$ 是严格凸函数。

#### 等价定义

**定义11 (凸函数的等价定义)**
函数 $f$ 是凸的，当且仅当它在与任意直线的交集上是凸的。即对于任意 $x \in \text{dom} f$ 和任意方向 $v \in \mathbb{R}^n$，函数 $g(t) = f(x+tv)$（作为 $t$ 的函数）是凸的。
> 直观理解：要判断一个多维函数是否是凸的，只需要检查它在所有“切片”（直线）上是否都是凸的。

### 一阶条件

**定理2 (凸函数的一阶条件)**
假设 $f$ 一阶可微。则 $f$ 是凸函数当且仅当 $\text{dom} f$ 是凸集，且对于所有 $x, y \in \text{dom} f$，满足：
$$
f(y) \ge f(x) + \nabla f(x)^T (y-x)
$$
> 直观理解：凸函数的图像一定位于它的任意一条切线的上方。这个不等式也表明，通过在某点 $x$ 的梯度信息，我们可以得到整个函数的一个全局下界。

-   **严格凸**：$f(y) > f(x) + \nabla f(x)^T (y-x)$ 对所有 $x \neq y$ 成立。
-   **凹**：$f(y) \le f(x) + \nabla f(x)^T (y-x)$。
-   **梯度单调性**：$f$ 是凸函数等价于 $(\nabla f(y) - \nabla f(x))^T(y-x) \ge 0$。

### 二阶条件

**定理3 (凸函数的二阶条件)**
假设 $f$ 二阶可微。则 $f$ 是凸函数当且仅当 $\text{dom} f$ 是凸集，且对于所有 $x \in \text{dom} f$，其Hessian矩阵是半正定的：
$$
\nabla^2 f(x) \succeq 0
$$
> 直观理解：对于一元函数，二阶条件是 $f''(x) \ge 0$，即函数的曲率非负。对于多元函数，Hessian矩阵半正定意味着函数在所有方向上的“曲率”都是非负的。

-   如果 $\nabla^2 f(x) \succ 0$ 对所有 $x$ 成立，则 $f$ 是**严格凸**的。
-   $f$ 是**凹**的当且仅当 $\nabla^2 f(x) \preceq 0$。

**例题3**：判断二次函数 $f(x) = \frac{1}{2}x^T Q x + q^T x + r$ 的凸性，其中 $Q$ 是对称矩阵。
**解**：
1.  计算梯度和Hessian矩阵：
    $$
    \nabla f(x) = Qx + q
    $$
    $$
    \nabla^2 f(x) = Q
    $$
2.  根据二阶条件，函数 $f(x)$ 的凸性完全由矩阵 $Q$ 决定：
    -   若 $Q \succeq 0$ (半正定)，则 $f(x)$ 是**凸函数**。
    -   若 $Q \succ 0$ (正定)，则 $f(x)$ 是**严格凸函数**。
    -   若 $Q \preceq 0$ (半负定)，则 $f(x)$ 是**凹函数**。

### 强凸函数定义

#### 基本定义

**定义13 (强凸函数)**
一个函数 $f$ 是 $\mu$-强凸的（$\mu > 0$），如果 $\text{dom} f$ 是凸集，且对于所有 $x, y \in \text{dom} f$ 和 $\theta \in [0, 1]$，满足：
$$
f(\theta x + (1-\theta)y) \le \theta f(x) + (1-\theta)f(y) - \frac{\mu}{2}\theta(1-\theta)\|x-y\|_2^2
$$
> 直观理解：强凸函数比普通凸函数“更凸”。它的图像不仅在弦的下方，而且离弦至少有一个二次函数的距离。

#### 等价定义

**定义14 (强凸函数的等价定义)**
函数 $f$ 是 $\mu$-强凸的，当且仅当函数 $g(x) = f(x) - \frac{\mu}{2}\|x\|_2^2$ 是一个凸函数。
> 直观理解：从一个强凸函数中减去一个足够小的二次函数，它仍然是凸的。

#### 一阶条件

**定理 (强凸函数的一阶条件)**
可微函数 $f$ 是 $\mu$-强凸的，当且仅当：
$$
f(y) \ge f(x) + \nabla f(x)^T (y-x) + \frac{\mu}{2}\|y-x\|_2^2
$$
> 直观理解：强凸函数的图像不仅在切线上方，而且至少高出一个二次函数。

#### 二阶条件

**定理 (强凸函数的二阶条件)**
二阶可微函数 $f$ 是 $\mu$-强凸的，当且仅当：
$$
\nabla^2 f(x) \succeq \mu I
$$
> 直观理解：Hessian矩阵的最小特征值处处都大于等于 $\mu$。

### 扩展

-   **广义实值函数**：可以将函数 $f$ 扩展为 $\tilde{f}$，使其定义域为全空间 $\mathbb{R}^n$：
    $$
    \tilde{f}(x) = \begin{cases} f(x) & x \in \text{dom} f \\ +\infty & x \notin \text{dom} f \end{cases}
    $$
    $f$ 是凸函数当且仅当 $\tilde{f}$ 是凸函数。
-   **示性函数**：对于集合 $C$，其示性函数 $\delta_C(x)$ 定义为：
    $$
    \delta_C(x) = \begin{cases} 0 & x \in C \\ \infty & x \notin C \end{cases}
    $$
    集合 $C$ 是凸集当且仅当其示性函数 $\delta_C(x)$ 是凸函数。

### 共轭函数

**定义15 (共轭函数)**
函数 $f$ 的共轭函数 $f^*$ 定义为：
$$
f^*(y) = \sup_{x \in \text{dom} f} (y^T x - f(x))
$$
> 直观理解：共轭函数 $f^*(y)$ 是对所有关于 $x$ 的仿射函数 $y^T x - c$ 的截距 $c$ 进行优化的结果，使得这些仿射函数始终是 $f(x)$ 的下界。无论原函数 $f$ 是否为凸，其共轭函数 $f^*$ 永远是凸函数。

### α-次水平集

**定义16 (α-次水平集)**
函数 $f$ 的 $\alpha$-次水平集 $C_\alpha$ 定义为：
$$
C_\alpha = \{ x \in \text{dom} f \mid f(x) \le \alpha \}
$$
> 直观理解：函数值小于等于某个阈值 $\alpha$ 的所有点的集合。如果一个函数是凸函数，那么它的所有次水平集都是凸集。

### 拟凸函数

**定义17 (拟凸函数)**
一个函数 $f$ 是拟凸的，如果它的定义域和所有 $\alpha$-次水平集都是凸集。
> 直观理解：拟凸函数是比凸函数更宽泛的一类函数。它的等高线围成的区域都是凸集。例如，$\sqrt{|x|}$ 是拟凸但非凸的。

**等价定义（单调性定义）：**  
设 $f: D \to \mathbb{R}$，其中 $D$ 是凸集。$f$ 是拟凸的，当且仅当对任意 $x, y \in D$ 和任意 $\lambda \in [0,1]$，有：
$$
f(\lambda x + (1-\lambda) y) \leq \max\{f(x), f(y)\}
$$


### 次梯度，次微分

**定义19 (次梯度和次微分)**
对于凸函数 $f$，向量 $g$ 是 $f$ 在点 $x$ 的一个**次梯度**，如果对于所有 $y \in \text{dom} f$ 满足：
$$
f(y) \ge f(x) + g^T(y-x)
$$
$f$ 在点 $x$ 的所有次梯度的集合称为**次微分**，记作 $\partial f(x)$。
> 直观理解：次梯度是梯度的推广，用于处理不可微的凸函数。在可微点，次微分集合中只有梯度这一个元素。在不可微点（例如 $|x|$ 在 $x=0$ 处），次微分是一个集合，包含了所有能支撑函数图像的“切线”的斜率。

**例题4**：计算 $f(x) = |x|$ 的次微分。
**解**：
1.  当 $x > 0$ 时，$f(x)$ 可微，梯度为 $f'(x) = 1$。所以 $\partial f(x) = \{1\}$。
2.  当 $x < 0$ 时，$f(x)$ 可微，梯度为 $f'(x) = -1$。所以 $\partial f(x) = \{-1\}$。
3.  当 $x = 0$ 时，$f(x)$ 不可微。我们需要找到所有满足 $f(y) \ge f(0) + g(y-0)$ 的 $g$。
    $$
    |y| \ge 0 + g \cdot y \implies |y| \ge gy
    $$
    -   若 $y>0$, $y \ge gy \implies g \le 1$。
    -   若 $y<0$, $-y \ge gy \implies g \ge -1$。
    -   综合起来，$g$ 必须满足 $-1 \le g \le 1$。
    所以，$\partial f(0) = [-1, 1]$。（实数区间集合，不是向量。）

## 凸优化问题

### 优化问题的一种具体表述形式

一个标准的优化问题可以写成：
$$
\begin{aligned}
\min_x \quad & f_0(x) \\
\text{s.t.} \quad & f_i(x) \le 0, \quad i=1, \dots, m \\
& h_j(x) = 0, \quad j=1, \dots, p
\end{aligned}
$$
-   $f_0(x)$: 目标函数
-   $f_i(x)$: 不等式约束函数
-   $h_j(x)$: 等式约束函数

### 一般表述

一个凸优化问题可以表示为：
$$
\min_x f(x) \quad \text{s.t.} \quad x \in \Omega
$$
其中目标函数 $f$ 是凸函数，可行集 $\Omega$ 是凸集。

### 凸优化问题特性

**定理6 (局部最优即全局最优)**
对于凸优化问题，任何局部最优解都是全局最优解。
> 直观理解：凸函数的图像是一个“碗”形，它只有一个最低点。一旦你找到了一个局部最低点（周围没有比它更低的点），那么这个点一定是整个碗的最低点。这个性质是凸优化如此重要的核心原因。

### 具体表述形式

一个标准的凸优化问题具有以下形式：
$$
\begin{aligned}
\min_x \quad & f_0(x) \\
\text{s.t.} \quad & f_i(x) \le 0, \quad i=1, \dots, m \\
& a_j^T x = b_j, \quad j=1, \dots, p
\end{aligned}
$$
-   目标函数 $f_0(x)$ 是**凸函数**。
-   不等式约束函数 $f_i(x)$ 是**凸函数**。
-   等式约束函数 $h_j(x) = a_j^T x - b_j$ 必须是**仿射函数**。

### 集合

-   **定义域** $\mathcal{D}$: 所有函数定义域的交集。
-   **可行域** $\mathcal{X}$: 属于定义域且满足所有约束的点的集合。
-   **最优值** $p^*$: 可行域上目标函数的下确界。
-   **最优解** $x^*$: 使得 $f_0(x^*) = p^*$ 的可行点。

### 连续可微问题的最优性理论

#### 下降方向

**命题7 (下降方向)**
对于可微函数 $f_0$，如果一个方向 $d$ 满足 $\nabla f_0(x)^T d < 0$，那么 $d$ 是 $f_0$ 在点 $x$ 的一个下降方向。
> 直观理解：如果一个方向与梯度的反方向（最速下降方向）夹角小于90度，那么沿着这个方向移动一小步，函数值就会减小。

#### 一般优化一阶必要条件

**命题8 (一阶必要条件)**
对于无约束优化问题，如果 $x^*$ 是一个局部最优点且 $f_0$ 可微，则必须满足：
$$
\nabla f_0(x^*) = 0
$$
> 直观理解：在最优点，函数的变化率为零，即“山谷”的谷底是平的。

#### 凸优化一阶充要条件

**命题9 (一阶充要条件)**
对于无约束**凸**优化问题，点 $x^*$ 是最优解的充分必要条件是：
$$
\nabla f_0(x^*) = 0
$$
> 直观理解：对于凸函数，任何梯度为零的点（驻点）都一定是全局最小值点。

#### 命题10

对于有约束凸优化问题 $\min_{x \in \mathcal{X}} f_0(x)$，点 $x^* \in \mathcal{X}$ 是最优解的充要条件是：
$$
\nabla f_0(x^*)^T (y - x^*) \ge 0, \quad \forall y \in \mathcal{X}
$$
> 直观理解：在最优点 $x^*$，负梯度方向 $-\nabla f_0(x^*)$ 与任何从 $x^*$ 指向可行域内部的方向 $y-x^*$ 的夹角都大于等于90度。这意味着从最优点出发，无法再沿着任何可行方向使目标函数下降。

### 优化问题例子

#### 线性规划 (LP)

目标函数和约束函数都是仿射函数。
$$
\begin{aligned}
\min_x \quad & c^T x + d \\
\text{s.t.} \quad & Gx \le h \\
& Ax = b
\end{aligned}
$$
> LP的可行域是一个多面体，最优解（如果存在）一定在多面体的某个顶点上达到。

#### 二次规划 (QP)

目标函数是凸二次函数，约束是仿射的。
$$
\begin{aligned}
\min_x \quad & \frac{1}{2}x^T Q x + q^T x + r \quad (Q \succeq 0) \\
\text{s.t.} \quad & Gx \le h \\
& Ax = b
\end{aligned}
$$

#### 回归问题

-   **最小二乘**：$\min_x \|Ax-b\|_2^2$。这是一个无约束QP。
-   **LASSO**：$\min_x \|Ax-b\|_2^2 + \lambda \|x\|_1$。用于产生稀疏解。
-   **岭回归**：$\min_x \|Ax-b\|_2^2 + \lambda \|x\|_2^2$。用于处理多重共线性。

### 半定规划 (SDP)

优化变量是矩阵，并有矩阵半正定约束。
$$
\begin{aligned}
\min_X \quad & \text{tr}(CX) \\
\text{s.t.} \quad & \text{tr}(A_i X) = b_i, \quad i=1, \dots, p \\
& X \succeq 0
\end{aligned}
$$
> SDP是比LP和QP更广泛的一类问题，在控制论和组合优化中有重要应用。

### 多目标规划

同时优化多个目标函数。
$$
\min_x \quad F(x) = (F_1(x), \dots, F_q(x))^T
$$
> 通常不存在一个解能同时使所有目标函数达到最优。因此，我们寻找的是一种权衡。

### 帕累托(Pareto)最优解

**定义21 (帕累托最优)**
一个可行解 $x$ 是帕累托最优的，如果没有其他可行解 $y$ 能够在所有目标上都比 $x$ 好（即 $F_i(y) \le F_i(x)$ 对所有 $i$ 成立），并且至少在一个目标上严格比 $x$ 好（即存在 $j$ 使得 $F_j(y) < F_j(x)$）。
> 直观理解：帕累托最优解是一个“无法改进”的解。任何对某个目标的改进都必然导致至少另一个目标的恶化。多目标优化的解通常是一个帕累托最优解的集合，称为帕累托前沿。